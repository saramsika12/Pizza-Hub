@{
	ViewData["Title"] = "Payment | Pizza Hub";
	Address address = TempData.Peek<Address>("Address");
}
<section>
	@if (Model != null)
	{
		<div class="row mt-3">
			<div class="col-lg-8">
				<div class="card mb-3">
					<div class="col-sm-12">
						<h5 class="mt-3">Order Details <span class="float-right"> Item(s):
							@Model.Cart.Items.Count
						</span></h5>
					</div>
					<hr />
					<div class="card-body pt-0 pb-0">
						@foreach (var item in Model.Cart.Items)
						{
							<div class="row">
								<div class="col-md-5 col-lg-3 col-xl-3">
									<div class="rounded mb-3 mb-md-0">
										<img class="rounded w-100"
										 src="@item.ImageUrl" alt="Sample">
									</div>
								</div>
								<div class="col-md-7 col-lg-9 col-xl-9">
									<div class="d-flex justify-content-between">
										<div>
											<h5>@item.Name</h5>
											<p class="mb-2 text-muted small">Size: Regular</p>
											<p class="mb-2 text-muted small">
												Unit Price: Rs @item.UnitPrice.ToString("##.#");
											</p>
										</div>
										<div>
											<div class="def-number-input number-input safari_only mb-0
                                               w-100">
											<div class="input-group mb-3">
												<input class="form-control sm-control" size="2"
												min="0" name="quantity" value="@item.Quantity" readonly />
											</div>
		                                </div>
										<span id="spanTotal" class="form-text text-muted text-
                                           center">
									   </span>
									</div>
								</div>

							</div>
						</div>
							@if (Model.Cart.Items.IndexOf(item) < Model.Cart.Items.Count - 1)
							{
								<hr class="mb-4">
							}

					}
					</div>
					<div class="col-sm-12">
						<h5 class="mt-2">Delivery Address</h5>
					</div>
					<hr />
					<div class="card-body pb-0">
						<dl class="row">
							<dt class="col-sm-2">
								Street
							</dt>
							<dd class="col-sm-4">
								@address.Street
							</dd>
							<dt class="col-sm-2">
								Locality
							</dt>
							<dd class="col-sm-4">
								@address.Locality
							</dd>
							<dt class="col-sm-2">
								Zip Code
							</dt>
							<dd class="col-sm-4">
								@address.ZipCode
							</dd>
							<dt class="col-sm-2">
								Contact No.
							</dt>
							<dd class="col-sm-4">
								@address.PhoneNumber
							</dd>
						</dl>
					</div>
				</div>
			</div>
			<div class="col-lg-4">
				<div class="card mb-3">
					<div class="col-sm-12">
						<h5 class="mt-3">Order Summary</h5>
					</div>
					<hr />
					<div class="card-body pt-0">
						<ul class="list-group list-group-flush">
							<li class="list-group-item d-flex justify-content-between align-items-center
                         border-0 px-0">
					 Amount
					 <span>Rs @Model.Cart.Total</span>
				             </li>
							 <li class="list-group-item d-flex justify-content-between align-items-center
                           border-0 px-0">
							 Tax (5%)
							 <span>+Rs @Model.Cart.Tax</span>

							 </li>
							<li class="list-group-item d-flex justify-content-between align-items-center
                           px-0 mb-3">
							<strong>Total Amount</strong>				
								<span><strong>Rs @Model.Cart.GrandTotal</strong></span>
							</li>
						</ul>
						@* @if (CurrentUser != null)
						{
							<button id="rzp-button" hidden>Pay</button>
							@using (Html.BeginForm("Status", "Payment", FormMethod.Post, new { id =
												"PaymentForm", name = "PaymentForm"
							}))
							{
								@Html.AntiForgeryToken()
								@Html.Hidden("Receipt",(string)Model.Receipt);
								@Html.Hidden("Currency", "NPR");
								@Html.Hidden("rzp_signature");
								@Html.Hidden("rzp_paymentid");
								@Html.Hidden("rzp_orderid");
								<button type="submit" id="rzp-paymentresponse" hidden style="display:
none;">Submit</button>
							} *@

						<body>
							<form action="https://rc-epay.esewa.com.np/api/epay/main/v2/form" method="POST">
								<input type="text" id="amount" name="amount" value="100" required>
								<input type="text" id="tax_amount" name="tax_amount" value="10" required>
								<input type="text" id="total_amount" name="total_amount" value="110" required>
								<input type="text" id="transaction_uuid" name="transaction_uuid" value="241028" required>
								<input type="text" id="product_code" name="product_code" value="EPAYTEST" required>
								<input type="text" id="product_service_charge" name="product_service_charge" value="0" required>
								<input type="text" id="product_delivery_charge" name="product_delivery_charge" value="0" required>
								<input type="text" id="success_url" name="success_url" value="https://esewa.com.np" required>
								<input type="text" id="failure_url" name="failure_url" value="https://google.com" required>
								<input type="text" id="signed_field_names" name="signed_field_names" value="total_amount,transaction_uuid,product_code" required>
								<input type="text" id="signature" name="signature" value="i94zsd3oXF6ZsSr/kGqT4sSzYQzjj1W/waxjWyRwaME=" required>
								<button type="submit" value="Pay with Esewa" class="btn btn-primary">Pay with Esewa</button>
							</form>
						</body>
					
					</div>
				</div>
			</div>
		</div>
	}
</section>